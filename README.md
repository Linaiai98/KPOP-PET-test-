# 虚拟宠物系统 (Virtual Pet System)

一个为 SillyTavern 设计的虚拟宠物插件，通过悬浮窗界面让你可以养育和照顾自己的虚拟宠物。

## ✨ 功能特色

### 🐾 宠物系统
- **多种宠物类型**: 猫咪、小狗、龙、兔子、小鸟等
- **宠物状态管理**: 健康、快乐、饥饿、精力四大属性
- **等级系统**: 通过互动获得经验值，宠物会升级成长
- **实时状态更新**: 宠物状态会随时间自然变化

### 🎮 互动功能
- **喂食**: 增加宠物的饥饿值和快乐度
- **玩耍**: 提升快乐度，消耗精力，获得更多经验
- **休息**: 恢复精力和健康值
- **冷却机制**: 防止过度互动，让养宠更有节奏感

### 🏆 成就系统
- **初次喂食**: 第一次喂食宠物
- **游戏达人**: 经常和宠物玩耍并达到一定等级
- **升级专家**: 宠物达到高等级

### 📱 响应式设计
- **悬浮窗界面**: 可拖拽的浮动按钮，不影响主界面使用
- **移动端适配**: 完美支持触摸操作和各种屏幕尺寸
- **现代化UI**: 与SillyTavern风格保持一致的界面设计

## 🚀 安装方法

### 方法一：通过SillyTavern扩展管理器安装（推荐）

1. 打开 SillyTavern，点击右上角的 **扩展** 图标 (🎲)
2. 在扩展页面中，点击 **下载扩展/更新** 按钮
3. 将以下仓库链接粘贴到输入框内：
   ```
   https://github.com/your-username/sillytavern-virtual-pet
   ```
4. 点击 `Download` 进行安装
5. 安装完成后，重新加载UI
6. 在扩展列表中找到并启用 "虚拟宠物系统"

### 方法二：手动安装

1. 下载本项目的所有文件
2. 将文件夹复制到 SillyTavern 的扩展目录：
   ```
   SillyTavern/public/scripts/extensions/third-party/virtual-pet-system/
   ```
3. 重启 SillyTavern
4. 在扩展设置中启用插件

## 📖 使用说明

### 基本操作

1. **启用插件**: 在扩展设置中勾选"启用虚拟宠物系统"
2. **打开界面**: 点击屏幕上出现的🐾浮动按钮
3. **照顾宠物**: 使用喂食、玩耍、休息按钮与宠物互动
4. **查看详情**: 点击"详细信息"查看宠物的详细状态和成就
5. **个性化设置**: 在设置页面修改宠物名称、类型等

### 宠物状态说明

- **健康 (Health)**: 宠物的整体健康状况，过度饥饿或疲劳会降低健康
- **快乐 (Happiness)**: 宠物的心情，通过喂食和玩耍可以提升
- **饥饿 (Hunger)**: 宠物的饱食程度，需要定期喂食维持
- **精力 (Energy)**: 宠物的体力，玩耍会消耗，休息可以恢复

### 互动冷却时间

- **喂食**: 30秒冷却
- **玩耍**: 1分钟冷却  
- **休息**: 2分钟冷却

## ⚙️ 配置选项

在扩展设置页面可以配置：

- **启用/禁用插件**: 控制插件的整体开关
- **宠物名称**: 自定义你的宠物名字
- **宠物类型**: 选择不同的宠物外观
- **自动保存**: 自动保存宠物状态（默认开启）
- **通知提醒**: 启用状态变化通知（默认开启）

### 🤖 AI API 配置

插件现在支持智能获取SillyTavern中可用的API：

- **自动发现**: 插件会自动尝试从SillyTavern获取可用的API列表
- **手动刷新**: 点击"🔄 刷新"按钮手动获取最新的API列表
- **多种来源**: 支持从SillyTavern上下文和API端点获取信息
- **智能识别**: 自动识别OpenAI、Claude、Google AI等主流API类型

#### 使用方法：
1. 在设置页面的AI配置部分，点击"🔄 刷新"按钮
2. 插件会自动扫描SillyTavern中可用的API和模型
3. 在下拉列表中选择检测到的API（标有✅图标）
4. 配置相应的API URL和密钥
5. 点击"🔗 测试连接"验证配置

#### 调试功能：
- 在浏览器控制台运行 `testVirtualPetAPIDiscovery()` 可以测试API发现功能
- 查看详细的API检测日志和结果

## 🔧 技术特性

- **数据持久化**: 宠物数据自动保存到浏览器本地存储
- **实时更新**: 宠物状态会根据时间流逝自动更新
- **响应式设计**: 适配各种设备和屏幕尺寸
- **触摸友好**: 完美支持移动设备的触摸操作
- **性能优化**: 轻量级设计，不影响SillyTavern性能

## 🐛 问题反馈

如果遇到问题或有功能建议，请：

1. 检查浏览器控制台是否有错误信息
2. 确认SillyTavern版本兼容性
3. 尝试禁用其他扩展排查冲突
4. 在GitHub Issues中提交问题报告

## 🗑️ 卸载插件

为了防止重新安装时出现"Directory already exists"错误，插件现在包含自动清理功能：

### 自动清理（推荐）
1. 在扩展设置中禁用插件
2. 系统会自动清理UI元素
3. 如需完全清理数据，在控制台运行：`cleanupVirtualPetSystem(true)`

### 手动清理
- 使用提供的清理脚本：`cleanup_plugin.bat`（Windows）或 `cleanup_plugin.sh`（Linux/Mac）
- 详细说明请查看 [UNINSTALL_GUIDE.md](UNINSTALL_GUIDE.md)

## 📝 更新日志

### v1.0.1 (2025-01-05)
- 🛠️ **新增自动卸载清理功能**
- 🔧 修复重装时的"Directory already exists"错误
- 📚 完善卸载指南和清理脚本
- ✨ 改进插件禁用时的清理逻辑
- 🧹 添加localStorage数据清理选项

### v1.0.0 (2024-12-27)
- 🎉 首次发布
- ✨ 基础宠物系统实现
- 🎮 互动功能（喂食、玩耍、休息）
- 📊 等级和经验系统
- 🏆 成就系统
- 📱 移动端适配
- ⚙️ 设置和个性化选项

## 📄 许可证

本项目采用 MIT 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情。

## 🙏 致谢

- 感谢 SillyTavern 团队提供优秀的平台
- 参考了 preset-manager-momo 的悬浮窗设计
- 感谢所有测试用户的反馈和建议
