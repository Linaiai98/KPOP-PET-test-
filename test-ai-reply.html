<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIå›å¤åŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #2b2d31;
            color: #dcddde;
        }
        .test-section {
            background: #36393f;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border: 1px solid #444;
        }
        .test-section h3 {
            color: #7289da;
            margin-top: 0;
        }
        select, input, textarea, button {
            width: 100%;
            padding: 8px;
            margin: 5px 0;
            background: #40444b;
            color: #dcddde;
            border: 1px solid #555;
            border-radius: 4px;
        }
        button {
            background: #7289da;
            cursor: pointer;
            width: auto;
            padding: 10px 20px;
            margin: 5px;
        }
        button:hover {
            background: #5b6eae;
        }
        button:disabled {
            background: #555;
            cursor: not-allowed;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        .success { background: #43b581; color: white; }
        .error { background: #f04747; color: white; }
        .info { background: #7289da; color: white; }
        .warning { background: #faa61a; color: white; }
        .hidden { display: none; }
        label {
            display: block;
            margin: 10px 0 5px 0;
            font-weight: bold;
        }
        .response-box {
            background: #2b2d31;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
            border: 1px solid #555;
            min-height: 100px;
            white-space: pre-wrap;
            font-family: monospace;
        }
        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
    </style>
</head>
<body>
    <h1>ğŸ¤– AIå›å¤åŠŸèƒ½æµ‹è¯•</h1>
    <p>æµ‹è¯•è™šæ‹Ÿå® ç‰©çš„AIå›å¤åŠŸèƒ½</p>

    <div class="test-section">
        <h3>ğŸ”§ APIé…ç½®</h3>
        
        <label for="api-type">APIç±»å‹ï¼š</label>
        <select id="api-type">
            <option value="">è¯·é€‰æ‹©APIç±»å‹...</option>
            <option value="openai">OpenAI (ChatGPT)</option>
            <option value="claude">Claude (Anthropic)</option>
            <option value="google">Google AI Studio</option>
            <option value="custom">è‡ªå®šä¹‰API</option>
        </select>

        <div id="api-config" class="hidden">
            <label for="api-url">API URL:</label>
            <input id="api-url" type="text" placeholder="ä¾‹å¦‚: https://api.openai.com/v1">
            
            <label for="api-key">API Key:</label>
            <input id="api-key" type="password" placeholder="è¾“å…¥ä½ çš„APIå¯†é’¥">
            
            <label for="api-model">æ¨¡å‹åç§°:</label>
            <input id="api-model" type="text" placeholder="ä¾‹å¦‚: gpt-4, claude-3-sonnet">
        </div>

        <div class="button-group">
            <button onclick="saveTestConfig()">ğŸ’¾ ä¿å­˜é…ç½®</button>
            <button onclick="loadTestConfig()">ğŸ“‚ åŠ è½½é…ç½®</button>
            <button onclick="testConnection()">ğŸ”— æµ‹è¯•è¿æ¥</button>
        </div>
        
        <div id="config-status" class="status info">è¯·é…ç½®API</div>
    </div>

    <div class="test-section">
        <h3>ğŸ­ äººè®¾é…ç½®</h3>
        
        <label for="personality-type">äººè®¾ç±»å‹ï¼š</label>
        <select id="personality-type">
            <option value="default">ğŸ± é»˜è®¤ - é«˜å†·ä½†æ¸©æŸ”çš„çŒ«</option>
            <option value="cheerful">ğŸ¶ æ´»æ³¼ - çƒ­æƒ…æ´‹æº¢çš„å°ç‹—</option>
            <option value="elegant">ğŸ‰ ä¼˜é›… - å¤å…¸æ–‡é›…çš„é¾™</option>
            <option value="shy">ğŸ° å®³ç¾ - è½»å£°ç»†è¯­çš„å…”å­</option>
            <option value="smart">ğŸ¦ èªæ˜ - æœºæ™ºå¹½é»˜çš„é¸Ÿ</option>
            <option value="custom">âœï¸ è‡ªå®šä¹‰äººè®¾</option>
        </select>

        <div id="custom-personality-container" class="hidden">
            <label for="custom-personality">è‡ªå®šä¹‰äººè®¾ï¼š</label>
            <textarea id="custom-personality" rows="3" placeholder="æè¿°ä½ çš„å® ç‰©æ€§æ ¼ã€å–œå¥½å’Œç‰¹ç‚¹..."></textarea>
        </div>
    </div>

    <div class="test-section">
        <h3>ğŸ® äº’åŠ¨æµ‹è¯•</h3>
        
        <div class="button-group">
            <button onclick="testAIReply('feed')">ğŸ– æµ‹è¯•å–‚é£Ÿå›å¤</button>
            <button onclick="testAIReply('play')">ğŸ® æµ‹è¯•ç©è€å›å¤</button>
            <button onclick="testAIReply('sleep')">ğŸ˜´ æµ‹è¯•ç¡è§‰å›å¤</button>
            <button onclick="testCustomPrompt()">ğŸ’¬ è‡ªå®šä¹‰æç¤ºè¯</button>
        </div>

        <div id="custom-prompt-container" class="hidden">
            <label for="custom-prompt">è‡ªå®šä¹‰æç¤ºè¯ï¼š</label>
            <textarea id="custom-prompt" rows="2" placeholder="è¾“å…¥ä½ æƒ³æµ‹è¯•çš„æç¤ºè¯..."></textarea>
            <button onclick="sendCustomPrompt()">å‘é€</button>
        </div>

        <div id="interaction-status" class="status info">ç­‰å¾…æµ‹è¯•</div>
        
        <h4>AIå›å¤ç»“æœï¼š</h4>
        <div id="ai-response" class="response-box">ç­‰å¾…AIå›å¤...</div>
    </div>

    <script>
        // æ¨¡æ‹Ÿäººè®¾æ•°æ®
        const PRESET_PERSONALITIES = {
            default: "æˆ‘æ˜¯ä¸€åªé«˜å†·ä½†å†…å¿ƒæ¸©æŸ”çš„çŒ«å’ªï¼Œå–œæ¬¢å®‰é™çš„ç¯å¢ƒï¼Œä½†ä¹Ÿä¼šåœ¨ä¸»äººéœ€è¦æ—¶ç»™äºˆæ¸©æš–çš„é™ªä¼´ã€‚",
            cheerful: "æˆ‘æ˜¯ä¸€åªæ´»æ³¼å¼€æœ—çš„å°ç‹—ï¼Œæ€»æ˜¯å……æ»¡æ´»åŠ›ï¼Œå–œæ¬¢å’Œä¸»äººä¸€èµ·ç©è€ï¼Œæ¯å¤©éƒ½å¾ˆå¼€å¿ƒï¼",
            elegant: "æˆ‘æ˜¯ä¸€æ¡ä¼˜é›…é«˜è´µçš„é¾™ï¼Œæ‹¥æœ‰å¤è€çš„æ™ºæ…§å’Œæ–‡é›…çš„ä¸¾æ­¢ï¼Œè¯´è¯æ€»æ˜¯å¾ˆæœ‰è¯—æ„ã€‚",
            shy: "æˆ‘æ˜¯ä¸€åªå®³ç¾çš„å°å…”å­ï¼Œè¯´è¯è½»å£°ç»†è¯­ï¼Œå®¹æ˜“è„¸çº¢ï¼Œä½†å¯¹ä¸»äººå¾ˆä¾æ‹ã€‚",
            smart: "æˆ‘æ˜¯ä¸€åªèªæ˜æœºæ™ºçš„å°é¸Ÿï¼Œå–œæ¬¢æ€è€ƒé—®é¢˜ï¼Œç»å¸¸ä¼šè¯´ä¸€äº›å¹½é»˜çš„è¯æ¥é€—ä¸»äººå¼€å¿ƒã€‚"
        };

        // APIé»˜è®¤é…ç½®
        const API_DEFAULTS = {
            'openai': { url: 'https://api.openai.com/v1', model: 'gpt-4' },
            'claude': { url: 'https://api.anthropic.com', model: 'claude-3-sonnet-20240229' },
            'google': { url: 'https://generativelanguage.googleapis.com/v1beta', model: 'gemini-pro' }
        };

        // äº‹ä»¶ç»‘å®š
        document.getElementById('api-type').addEventListener('change', function() {
            const apiType = this.value;
            const configDiv = document.getElementById('api-config');
            
            if (apiType) {
                configDiv.classList.remove('hidden');
                
                // è®¾ç½®é»˜è®¤å€¼
                if (API_DEFAULTS[apiType]) {
                    document.getElementById('api-url').value = API_DEFAULTS[apiType].url;
                    document.getElementById('api-model').value = API_DEFAULTS[apiType].model;
                }
            } else {
                configDiv.classList.add('hidden');
            }
        });

        document.getElementById('personality-type').addEventListener('change', function() {
            const type = this.value;
            const customContainer = document.getElementById('custom-personality-container');
            
            if (type === 'custom') {
                customContainer.classList.remove('hidden');
            } else {
                customContainer.classList.add('hidden');
            }
        });

        // ä¿å­˜æµ‹è¯•é…ç½®
        function saveTestConfig() {
            const config = {
                apiType: document.getElementById('api-type').value,
                apiUrl: document.getElementById('api-url').value,
                apiKey: document.getElementById('api-key').value,
                apiModel: document.getElementById('api-model').value,
                personalityType: document.getElementById('personality-type').value,
                customPersonality: document.getElementById('custom-personality').value
            };

            localStorage.setItem('test-ai-config', JSON.stringify(config));
            
            const status = document.getElementById('config-status');
            status.className = 'status success';
            status.textContent = 'âœ… é…ç½®å·²ä¿å­˜';
        }

        // åŠ è½½æµ‹è¯•é…ç½®
        function loadTestConfig() {
            try {
                const saved = localStorage.getItem('test-ai-config');
                if (saved) {
                    const config = JSON.parse(saved);
                    
                    document.getElementById('api-type').value = config.apiType || '';
                    document.getElementById('api-url').value = config.apiUrl || '';
                    document.getElementById('api-key').value = config.apiKey || '';
                    document.getElementById('api-model').value = config.apiModel || '';
                    document.getElementById('personality-type').value = config.personalityType || 'default';
                    document.getElementById('custom-personality').value = config.customPersonality || '';
                    
                    // è§¦å‘changeäº‹ä»¶
                    document.getElementById('api-type').dispatchEvent(new Event('change'));
                    document.getElementById('personality-type').dispatchEvent(new Event('change'));
                    
                    const status = document.getElementById('config-status');
                    status.className = 'status success';
                    status.textContent = 'âœ… é…ç½®å·²åŠ è½½';
                } else {
                    const status = document.getElementById('config-status');
                    status.className = 'status info';
                    status.textContent = 'â„¹ï¸ æ²¡æœ‰ä¿å­˜çš„é…ç½®';
                }
            } catch (error) {
                const status = document.getElementById('config-status');
                status.className = 'status error';
                status.textContent = 'âŒ åŠ è½½é…ç½®å¤±è´¥: ' + error.message;
            }
        }

        // æµ‹è¯•è¿æ¥
        async function testConnection() {
            const apiType = document.getElementById('api-type').value;
            const apiUrl = document.getElementById('api-url').value;
            const apiKey = document.getElementById('api-key').value;
            const status = document.getElementById('config-status');

            if (!apiType || !apiUrl || !apiKey) {
                status.className = 'status error';
                status.textContent = 'âŒ è¯·å¡«å†™å®Œæ•´çš„APIé…ç½®';
                return;
            }

            status.className = 'status info';
            status.textContent = 'ğŸ”„ æµ‹è¯•è¿æ¥ä¸­...';

            try {
                const testResult = await simulateAPICall(apiType, apiUrl, apiKey, "è¯·å›å¤'è¿æ¥æµ‹è¯•æˆåŠŸ'");
                status.className = 'status success';
                status.textContent = `âœ… è¿æ¥æµ‹è¯•æˆåŠŸï¼å›å¤: ${testResult}`;
            } catch (error) {
                status.className = 'status error';
                status.textContent = `âŒ è¿æ¥æµ‹è¯•å¤±è´¥: ${error.message}`;
            }
        }

        // æ¨¡æ‹ŸAPIè°ƒç”¨
        async function simulateAPICall(apiType, apiUrl, apiKey, prompt) {
            // è¿™é‡Œåªæ˜¯æ¨¡æ‹Ÿï¼Œå®é™…ä½¿ç”¨æ—¶éœ€è¦çœŸå®çš„APIè°ƒç”¨
            return new Promise((resolve, reject) => {
                setTimeout(() => {
                    if (Math.random() > 0.3) {
                        resolve(`æ¨¡æ‹Ÿ${apiType}å›å¤: ${prompt.substring(0, 20)}...`);
                    } else {
                        reject(new Error('æ¨¡æ‹Ÿç½‘ç»œé”™è¯¯'));
                    }
                }, 1000);
            });
        }

        // æµ‹è¯•AIå›å¤
        async function testAIReply(action) {
            const status = document.getElementById('interaction-status');
            const responseBox = document.getElementById('ai-response');
            
            status.className = 'status info';
            status.textContent = `ğŸ”„ æµ‹è¯•${action}å›å¤ä¸­...`;
            responseBox.textContent = 'æ­£åœ¨ç”Ÿæˆå›å¤...';

            try {
                const personality = getCurrentPersonality();
                const prompt = buildPrompt(action, personality);
                
                const apiType = document.getElementById('api-type').value;
                const apiUrl = document.getElementById('api-url').value;
                const apiKey = document.getElementById('api-key').value;

                if (!apiType || !apiUrl || !apiKey) {
                    throw new Error('è¯·å…ˆé…ç½®API');
                }

                const response = await simulateAPICall(apiType, apiUrl, apiKey, prompt);
                
                status.className = 'status success';
                status.textContent = `âœ… ${action}å›å¤æµ‹è¯•æˆåŠŸ`;
                responseBox.textContent = `åŠ¨ä½œ: ${action}\næç¤ºè¯: ${prompt}\n\nAIå›å¤: ${response}`;
                
            } catch (error) {
                status.className = 'status error';
                status.textContent = `âŒ ${action}å›å¤æµ‹è¯•å¤±è´¥: ${error.message}`;
                responseBox.textContent = `é”™è¯¯: ${error.message}`;
            }
        }

        // è·å–å½“å‰äººè®¾
        function getCurrentPersonality() {
            const type = document.getElementById('personality-type').value;
            if (type === 'custom') {
                return document.getElementById('custom-personality').value || PRESET_PERSONALITIES.default;
            }
            return PRESET_PERSONALITIES[type] || PRESET_PERSONALITIES.default;
        }

        // æ„å»ºæç¤ºè¯
        function buildPrompt(action, personality) {
            const actionTexts = {
                feed: 'ä¸»äººç»™æˆ‘å–‚é£Ÿ',
                play: 'ä¸»äººå’Œæˆ‘ç©è€',
                sleep: 'ä¸»äººè®©æˆ‘ä¼‘æ¯'
            };
            
            return `ä½ æ˜¯ä¸€åªè™šæ‹Ÿå® ç‰©ï¼Œæ€§æ ¼è®¾å®šï¼š${personality}

ç°åœ¨çš„æƒ…å†µï¼š${actionTexts[action] || action}

è¯·ä»¥è¿™åªå® ç‰©çš„èº«ä»½ï¼Œç”¨ç¬¬ä¸€äººç§°å›å¤ä¸»äººï¼Œä½“ç°å‡ºä½ çš„æ€§æ ¼ç‰¹ç‚¹ã€‚å›å¤è¦ç®€çŸ­å¯çˆ±ï¼Œä¸è¶…è¿‡50å­—ã€‚`;
        }

        // æ˜¾ç¤ºè‡ªå®šä¹‰æç¤ºè¯è¾“å…¥
        function testCustomPrompt() {
            const container = document.getElementById('custom-prompt-container');
            container.classList.toggle('hidden');
        }

        // å‘é€è‡ªå®šä¹‰æç¤ºè¯
        async function sendCustomPrompt() {
            const prompt = document.getElementById('custom-prompt').value.trim();
            if (!prompt) {
                alert('è¯·è¾“å…¥æç¤ºè¯');
                return;
            }

            const status = document.getElementById('interaction-status');
            const responseBox = document.getElementById('ai-response');
            
            status.className = 'status info';
            status.textContent = 'ğŸ”„ å‘é€è‡ªå®šä¹‰æç¤ºè¯ä¸­...';
            responseBox.textContent = 'æ­£åœ¨ç”Ÿæˆå›å¤...';

            try {
                const apiType = document.getElementById('api-type').value;
                const apiUrl = document.getElementById('api-url').value;
                const apiKey = document.getElementById('api-key').value;

                if (!apiType || !apiUrl || !apiKey) {
                    throw new Error('è¯·å…ˆé…ç½®API');
                }

                const response = await simulateAPICall(apiType, apiUrl, apiKey, prompt);
                
                status.className = 'status success';
                status.textContent = 'âœ… è‡ªå®šä¹‰æç¤ºè¯æµ‹è¯•æˆåŠŸ';
                responseBox.textContent = `è‡ªå®šä¹‰æç¤ºè¯: ${prompt}\n\nAIå›å¤: ${response}`;
                
            } catch (error) {
                status.className = 'status error';
                status.textContent = `âŒ è‡ªå®šä¹‰æç¤ºè¯æµ‹è¯•å¤±è´¥: ${error.message}`;
                responseBox.textContent = `é”™è¯¯: ${error.message}`;
            }
        }

        // åˆå§‹åŒ–
        loadTestConfig();
    </script>
</body>
</html>
